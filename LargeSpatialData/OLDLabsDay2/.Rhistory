knitr::opts_chunk$set(echo = TRUE, fig.width=5, fig.height=5, fig.align = "center")
suppressMessages(library( LatticeKrig))
fields.style()
u<- seq( 0,1,length.out=8)
sGrid<- seq( 0,1,length.out= 100)
Omega<- exp( -rdist( u,u)/.2)
X<- Wendland2.2( rdist( sGrid, u)/.4)
matplot( sGrid, X, type="l")
covG<- X%*%Omega%*%t(X)
locs<- c( 10, 20, 50, 85)
matplot( sGrid, covG[,locs], type="l", lty=1)
xline( sGrid[locs], col="grey30", lwd=2)
set.seed(2232)
B<- chol( Omega)
c<- t(B)%*%rnorm( 8)
g1<- X%*%c
fields.style()
plot( sGrid, g1, type="l")
c<- t(B)%*%rnorm( 8)
g2<- X%*%c
c<- t(B)%*%rnorm( 8)
g3<- X%*%c
matplot( sGrid, cbind( g1,g2,g3), type="l",
lty=1, lwd=3)
#knot locations
xline( u, lwd=.5)
Q<- solve( Omega)
image.plot( Q, col=viridis())
Q<- solve( Omega)
image.plot( Q, col=two.colors(256))
dev.off()
Q<- solve( Omega)
image.plot( Q, col=two.colors(256))
